@* ================================================= *@

@* Components/Reports/ReportViolations.razor *@
@using ComputerStore.Models.DTOs

<h4 class="mb-4">Торговые точки с превышением лимита кассы</h4>

@if (Data.Any())
{
    <div class="alert alert-danger">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <strong>Обнаружено нарушений:</strong> @Data.Count
    </div>

    <div class="table-responsive">
        <table class="table table-hover">
            <thead class="table-light">
                <tr>
                    <th>Торговая точка</th>
                    <th>Касса</th>
                    <th>Дата нарушения</th>
                    <th>Лимит</th>
                    <th>Фактическая сумма</th>
                    <th>Превышение</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var v in Data.OrderByDescending(d => d.ViolationDate))
                {
                    <tr class="table-danger">
                        <td>@v.StorePointName</td>
                        <td><code>@v.CashRegisterNumber</code></td>
                        <td>@v.ViolationDate.ToString("dd.MM.yyyy")</td>
                        <td>@v.LimitAmount.ToString("C0")</td>
                        <td class="fw-bold text-danger">@v.ActualAmount.ToString("C0")</td>
                        <td class="fw-bold">+@v.ExcessAmount.ToString("C0")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div class="alert alert-success">
        <i class="bi bi-check-circle-fill me-2"></i>
        Нарушений лимита кассы не обнаружено
    </div>
}

@code {
    [Parameter] public List<CashLimitViolationDto> Data { get; set; } = new();
}